#!/bin/sh
## script to automate wall change and pywal updates

if [ -z $1]; then
  echo "Wallpaper path must be provided"
  exit 1;
fi
image_path=$(realpath "$1")
wal_cache_dir="${HOME}/.cache/wal/"
## konsole
term_cs_path="${HOME}/.local/share/konsole/wal.colorscheme"
wal_cs_path="${wal_cache_dir}colors-konsole.colorscheme"
term_opacity="0.85"
## vim
vim_color_path="${HOME}/.vim/colors/wal.vim"
wal_vim_path="${wal_cache_dir}/colors-wal.vim"

shift

echo "Wallpaper: $image_path"

echo "Copying $image_path -> ${HOME}/config/wall.jpg"
cp $image_path ~/.config/wall.jpg

echo "Calling pywal"
## -i image name
## -n skip setting wallpaper
## -s skip changing colors in terminals
## -q quiet mode
wal -nsq -i $image_path $@

echo "setting konsole colorscheme with opacity ${term_opacity}"
cat "$wal_cs_path" > "$term_cs_path" 
echo "Opacity=${term_opacity}" >> "$term_cs_path"

echo "setting vim colorschme"
cat "$wal_vim_path" > "$vim_color_path"

echo "Everything Done"
